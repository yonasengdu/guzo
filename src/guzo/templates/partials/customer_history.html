{% if bookings %}
<div class="space-y-4">
    {% for booking in bookings %}
    <div class="card-apple p-6">
        <div class="flex items-start justify-between">
            <div class="flex-1">
                <!-- Route -->
                <div class="flex items-center gap-3 mb-3">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        <span class="text-apple-gray-900 font-medium">{{ booking.pickup_location }}</span>
                    </div>
                    <svg class="w-4 h-4 text-apple-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                    </svg>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                        <span class="text-apple-gray-900 font-medium">{{ booking.dropoff_location }}</span>
                    </div>
                </div>
                
                <!-- Details -->
                <div class="flex items-center gap-4 text-sm text-apple-gray-500">
                    <span>{{ booking.scheduled_time.strftime('%b %d, %Y') }}</span>
                    <span class="text-apple-gray-300">•</span>
                    <span>{{ booking.scheduled_time.strftime('%H:%M') }}</span>
                    <span class="text-apple-gray-300">•</span>
                    <span>{{ booking.seats_booked }} seat{% if booking.seats_booked > 1 %}s{% endif %}</span>
                    {% if booking.price %}
                    <span class="text-apple-gray-300">•</span>
                    <span class="font-medium text-apple-gray-700">{{ booking.price }} ETB</span>
                    {% endif %}
                </div>
                
                <!-- Driver Info -->
                {% if booking.driver_name %}
                <div class="mt-3 pt-3 border-t border-apple-gray-100">
                    <div class="flex items-center gap-2">
                        <div class="w-8 h-8 bg-apple-gray-100 rounded-full flex items-center justify-center">
                            <span class="text-sm font-medium text-apple-gray-600">{{ booking.driver_name[0] }}</span>
                        </div>
                        <div>
                            <p class="text-sm font-medium text-apple-gray-900">{{ booking.driver_name }}</p>
                            {% if booking.driver_rating %}
                            <div class="flex items-center gap-1">
                                <span class="text-yellow-500">★</span>
                                <span class="text-xs text-apple-gray-500">{{ booking.driver_rating }}</span>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            
            <div class="flex flex-col items-end gap-2">
                <!-- Status Badge -->
                {% if booking.status.value == 'completed' %}
                <span class="badge-apple badge-success">Completed</span>
                {% elif booking.status.value == 'cancelled' %}
                <span class="badge-apple badge-error">Cancelled</span>
                {% elif booking.status.value == 'confirmed' %}
                <span class="badge-apple badge-info">Confirmed</span>
                {% else %}
                <span class="badge-apple badge-warning">{{ booking.status.value|capitalize }}</span>
                {% endif %}
                
                <!-- Actions -->
                <div class="flex items-center gap-2 mt-2">
                    <button 
                        class="text-sm text-apple-blue hover:underline"
                        hx-post="/customer/rebook/{{ booking.id }}"
                        hx-swap="innerHTML"
                    >
                        Rebook
                    </button>
                    
                    {% if booking.status.value == 'completed' and not booking.customer_review_id and booking.assigned_driver_id %}
                    <span class="text-apple-gray-300">•</span>
                    <button 
                        class="text-sm text-apple-blue hover:underline"
                        hx-get="/reviews/form/{{ booking.id }}?reviewee_id={{ booking.assigned_driver_id }}"
                        hx-target="#review-modal-content"
                        hx-swap="innerHTML"
                        onclick="document.getElementById('review-modal').classList.remove('hidden')"
                    >
                        Leave Review
                    </button>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="card-apple p-12 text-center">
    <p class="text-apple-gray-500">No trips found</p>
</div>
{% endif %}

