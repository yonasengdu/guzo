{% if users %}
<div class="card-apple overflow-hidden">
    <table class="table-apple w-full">
        <thead>
            <tr>
                <th>User</th>
                <th>Contact</th>
                <th>Role</th>
                <th>Rating</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for u in users %}
            <tr id="user-row-{{ u.id }}">
                <td>
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-apple-gray-100 rounded-full flex items-center justify-center">
                            {% if u.profile_image %}
                            <img src="{{ u.profile_image }}" alt="{{ u.full_name }}" class="w-10 h-10 rounded-full object-cover">
                            {% else %}
                            <span class="font-semibold text-apple-gray-600">{{ u.full_name[0] }}</span>
                            {% endif %}
                        </div>
                        <div>
                            <p class="font-medium text-apple-gray-600">{{ u.full_name }}</p>
                            <p class="text-xs text-apple-gray-400">Joined {{ u.created_at.strftime('%b %d, %Y') }}</p>
                        </div>
                    </div>
                </td>
                <td>
                    <p class="text-apple-gray-600">{{ u.email }}</p>
                    <p class="text-sm text-apple-gray-400">{{ u.phone or '-' }}</p>
                </td>
                <td>
                    {% if u.role.value == 'driver' %}
                    <span class="badge-apple badge-info">Driver</span>
                    {% elif u.role.value == 'admin' %}
                    <span class="badge-apple" style="background: rgba(156, 39, 176, 0.12); color: #7b1fa2;">Admin</span>
                    {% else %}
                    <span class="badge-apple badge-success">Rider</span>
                    {% endif %}
                </td>
                <td>
                    <div class="flex items-center gap-1">
                        <span class="text-yellow-500">â˜…</span>
                        <span class="text-apple-gray-600">{{ u.rating|round(1) }}</span>
                        <span class="text-xs text-apple-gray-400">({{ u.total_ratings }})</span>
                    </div>
                </td>
                <td>
                    <div class="flex items-center gap-2">
                        {% if u.is_active %}
                        <span class="badge-apple badge-success">Active</span>
                        {% else %}
                        <span class="badge-apple badge-error">Inactive</span>
                        {% endif %}
                        
                        {% if u.role.value == 'driver' %}
                            {% if u.is_verified_by_admin %}
                            <span class="badge-apple badge-info">Verified</span>
                            {% else %}
                            <span class="badge-apple badge-warning">Unverified</span>
                            {% endif %}
                        {% endif %}
                    </div>
                </td>
                <td>
                    <div class="flex items-center gap-2">
                        {% if u.is_active %}
                        <button 
                            class="text-sm text-apple-red hover:underline"
                            hx-post="/admin/user/{{ u.id }}/deactivate"
                            hx-target="#user-row-{{ u.id }}"
                            hx-swap="outerHTML"
                            hx-confirm="Deactivate this user?"
                        >
                            Deactivate
                        </button>
                        {% else %}
                        <button 
                            class="text-sm text-apple-green hover:underline"
                            hx-post="/admin/user/{{ u.id }}/activate"
                            hx-target="#user-row-{{ u.id }}"
                            hx-swap="outerHTML"
                        >
                            Activate
                        </button>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="card-apple p-12 text-center">
    <svg class="w-16 h-16 text-apple-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
    </svg>
    <p class="text-apple-gray-400">No users found</p>
</div>
{% endif %}

