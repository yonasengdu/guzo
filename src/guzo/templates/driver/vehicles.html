{% extends "dashboard_base.html" %}

{% block title %}My Vehicles - Guzo{% endblock %}

{% block dashboard_content %}
<!-- Header -->
<div class="flex items-center justify-between mb-8">
    <div>
        <h1 class="text-3xl font-semibold text-apple-gray-600">My Vehicles</h1>
        <p class="text-apple-gray-400 mt-1">Manage your registered vehicles</p>
    </div>
    <button 
        class="btn-apple btn-apple-primary"
        onclick="document.getElementById('add-vehicle-modal').classList.remove('hidden')"
    >
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
        </svg>
        Add Vehicle
    </button>
</div>

<!-- Vehicles List -->
<div id="vehicles-list" class="space-y-4">
    {% if vehicles %}
    {% for vehicle in vehicles %}
    <div class="card-apple p-6" id="vehicle-{{ vehicle.id }}">
        <div class="flex items-start justify-between">
            <div class="flex items-start gap-4">
                <div class="w-16 h-16 bg-apple-gray-100 rounded-xl flex items-center justify-center">
                    <svg class="w-8 h-8 text-apple-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
                    </svg>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-apple-gray-600">{{ vehicle.make }} {{ vehicle.model }}</h3>
                    <p class="text-apple-gray-400">{{ vehicle.plate_number }}</p>
                    <div class="flex items-center gap-3 mt-2">
                        <span class="text-sm text-apple-gray-400">{{ vehicle.vehicle_type.value|capitalize }}</span>
                        <span class="text-apple-gray-300">•</span>
                        <span class="text-sm text-apple-gray-400">{{ vehicle.capacity }} seats</span>
                        {% if vehicle.year %}
                        <span class="text-apple-gray-300">•</span>
                        <span class="text-sm text-apple-gray-400">{{ vehicle.year }}</span>
                        {% endif %}
                        {% if vehicle.color %}
                        <span class="text-apple-gray-300">•</span>
                        <span class="text-sm text-apple-gray-400">{{ vehicle.color }}</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-2">
                {% if vehicle.is_verified_by_admin %}
                <span class="badge-apple badge-success">Verified</span>
                {% else %}
                <span class="badge-apple badge-warning">Pending</span>
                {% endif %}
                
                <button 
                    class="p-2 text-apple-red hover:bg-apple-red/10 rounded-lg transition-colors"
                    hx-delete="/driver/vehicle/{{ vehicle.id }}"
                    hx-target="#vehicle-{{ vehicle.id }}"
                    hx-swap="outerHTML"
                    hx-confirm="Are you sure you want to delete this vehicle?"
                >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="card-apple p-12 text-center">
        <svg class="w-16 h-16 text-apple-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>
        </svg>
        <p class="text-apple-gray-400">No vehicles registered yet</p>
        <p class="text-apple-gray-400 text-sm mt-1">Add your first vehicle to start offering rides</p>
    </div>
    {% endif %}
</div>

<!-- Add Vehicle Modal -->
<div id="add-vehicle-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6 border-b border-apple-gray-100">
            <div class="flex items-center justify-between">
                <h2 class="text-xl font-semibold text-apple-gray-600">Add Vehicle</h2>
                <button onclick="document.getElementById('add-vehicle-modal').classList.add('hidden')" class="text-apple-gray-400 hover:text-apple-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <form hx-post="/driver/vehicle/create" hx-swap="none" hx-on::after-request="if(event.detail.successful) { location.reload(); }" class="p-6 space-y-4">
            <div>
                <label class="block text-sm font-medium text-apple-gray-500 mb-2">Plate Number</label>
                <input type="text" name="plate_number" required class="input-apple" placeholder="AA-12345">
            </div>
            
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-apple-gray-500 mb-2">Make</label>
                    <input type="text" name="make" required class="input-apple" placeholder="Toyota">
                </div>
                <div>
                    <label class="block text-sm font-medium text-apple-gray-500 mb-2">Model</label>
                    <input type="text" name="model" required class="input-apple" placeholder="HiAce">
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-apple-gray-500 mb-2">Year</label>
                    <input type="number" name="year" min="1990" max="2030" class="input-apple" placeholder="2020">
                </div>
                <div>
                    <label class="block text-sm font-medium text-apple-gray-500 mb-2">Color</label>
                    <input type="text" name="color" class="input-apple" placeholder="White">
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-apple-gray-500 mb-2">Vehicle Type</label>
                    <select name="vehicle_type" class="select-apple">
                        <option value="sedan">Sedan</option>
                        <option value="suv">SUV</option>
                        <option value="minibus">Minibus</option>
                        <option value="bus">Bus</option>
                        <option value="van">Van</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-apple-gray-500 mb-2">Capacity</label>
                    <input type="number" name="capacity" required min="1" max="50" class="input-apple" placeholder="4">
                </div>
            </div>
            
            <div class="pt-4 flex gap-3">
                <button type="button" onclick="document.getElementById('add-vehicle-modal').classList.add('hidden')" class="btn-apple btn-apple-secondary flex-1">
                    Cancel
                </button>
                <button type="submit" class="btn-apple btn-apple-primary flex-1">
                    Add Vehicle
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
